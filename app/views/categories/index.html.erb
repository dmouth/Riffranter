<%= page_title "Categories" %>
<% admin_area do %>
  <p><%= link_to 'New Category', new_category_path %></p>
<% end %>

<h1>Personas by Category</h1>
<div class='shadow-box'>
	<table  cellpadding="5" cellspacing="0" class="index-table" width="100%">
		<% for categories in @categories.in_groups_of(4, nil) %>
	  <tr class="<%= cycle "odd-row", "even-row" %>">
			<% categories.each do |category| %>
	    <td width="25%'">
				<%  if category %>
						<%= link_to "#{category.name} (#{category.personas.count})", category %>
					<% admin_area do %>
			   		<div>
							<%= link_to 'Show', category %> |
					    <%= link_to 'Edit', edit_category_path(category) %> |
					    <%= link_to 'Delete', category, :confirm => 'Are you sure?', :method => :delete %>
						</div>
					<% end %>
				<% end %>
			<% end %>
		</td>
	  </tr>
	<% end %>
	</table>
</div>

<h1>Latest Rants by Category</h1>
<div class="directory">
  Go to: <%= raw @categories.collect{|c| link_to c.name, "##{c.name.gsub(/\s/, "_").downcase}"}.join(" | ") %>
</div>

<% for cat in @categories %>
  <h2 id="<%= cat.name.gsub(/\s/, "_").downcase %>"><%= cat.name %></h2>
  <%= render :partial => "shared/rant_collection", :locals => {:rants => Rant.order(:created_at.desc).where({:persona_id.in => cat.persona_ids}).limit(5)} %>
<% end %>

<% admin_area do %>
  <p><%= link_to 'New Category', new_category_path %></p>
<% end %>
